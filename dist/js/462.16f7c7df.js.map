{"version":3,"file":"js/462.16f7c7df.js","mappings":"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","sources":["webpack://lowcode_demo/./src/custom-component/VLink/Component.vue","webpack://lowcode_demo/src/custom-component/VLink/Component.vue","webpack://lowcode_demo/./src/custom-component/VLink/Component.vue?0de3","webpack://lowcode_demo/./src/custom-component/VLink/Component.vue?85db","webpack://lowcode_demo/./src/custom-component/common/OnEvent.vue","webpack://lowcode_demo/src/custom-component/common/OnEvent.vue","webpack://lowcode_demo/./src/custom-component/common/OnEvent.vue?976a"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.editMode == 'edit')?_c('div',{staticClass:\"v-text\",on:{\"keydown\":_vm.handleKeydown,\"keyup\":_vm.handleKeyup}},[_c('el-link',{ref:\"text\",class:{ canEdit: _vm.canEdit },style:({ verticalAlign: _vm.element.style.verticalAlign }),attrs:{\"type\":\"primary\",\"contenteditable\":_vm.canEdit,\"tabindex\":_vm.element.id},domProps:{\"innerHTML\":_vm._s(_vm.element.propValue.text)},on:{\"dblclick\":_vm.setEdit,\"paste\":_vm.clearStyle,\"mousedown\":_vm.handleMousedown,\"blur\":_vm.handleBlur,\"input\":_vm.handleInput,\"click\":_vm.openLink}})],1):_c('div',{staticClass:\"v-text preview\"},[_c('el-link',{style:({ verticalAlign: _vm.element.style.verticalAlign }),attrs:{\"type\":\"primary\"},domProps:{\"innerHTML\":_vm._s(_vm.element.propValue.text)},on:{\"click\":_vm.openLink}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div\r\n        v-if=\"editMode == 'edit'\"\r\n        class=\"v-text\"\r\n        @keydown=\"handleKeydown\"\r\n        @keyup=\"handleKeyup\"\r\n    >\r\n        <!-- tabindex >= 0 使得双击时聚焦该元素 -->\r\n        <el-link \r\n            ref=\"text\"\r\n            type=\"primary\"\r\n            :contenteditable=\"canEdit\"\r\n            :class=\"{ canEdit }\"\r\n            :tabindex=\"element.id\"\r\n            :style=\"{ verticalAlign: element.style.verticalAlign }\"\r\n            @dblclick=\"setEdit\"\r\n            @paste=\"clearStyle\"\r\n            @mousedown=\"handleMousedown\"\r\n            @blur=\"handleBlur\"  \r\n            @input=\"handleInput\"\r\n            @click=\"openLink\"\r\n            v-html=\"element.propValue.text\"\r\n        ></el-link>\r\n    </div>\r\n    <div v-else class=\"v-text preview\">\r\n        <el-link \r\n            type=\"primary\" \r\n            :style=\"{ verticalAlign: element.style.verticalAlign }\" \r\n            @click=\"openLink\" \r\n            v-html=\"element.propValue.text\"\r\n        ></el-link>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport { keycodes } from '@/utils/shortcutKey.js'\r\nimport OnEvent from '../common/OnEvent'\r\n\r\nexport default {\r\n    extends: OnEvent,\r\n    props: {\r\n        propValue: {\r\n            type: Object,\r\n            require: true,\r\n            default: () => {},\r\n        },\r\n        element: {\r\n            type: Object,\r\n            default: () => {},\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n            canEdit: false,\r\n            ctrlKey: 17,\r\n            isCtrlDown: false,\r\n        }\r\n    },\r\n    computed: {\r\n        ...mapState([\r\n            'editMode',\r\n        ]),\r\n    },\r\n    methods: {\r\n        openLink() {\r\n            window.open(this.element.propValue.link)\r\n        },\r\n\r\n        handleInput(e) {\r\n            this.$emit('input', this.element, e.target.innerHTML)\r\n        },\r\n\r\n        handleKeydown(e) {\r\n            // 阻止冒泡，防止触发复制、粘贴组件操作\r\n            this.canEdit && e.stopPropagation()\r\n            if (e.keyCode == this.ctrlKey) {\r\n                this.isCtrlDown = true\r\n            } else if (this.isCtrlDown && this.canEdit && keycodes.includes(e.keyCode)) {\r\n                e.stopPropagation()\r\n            } else if (e.keyCode == 46) { // deleteKey\r\n                e.stopPropagation()\r\n            }\r\n        },\r\n\r\n        handleKeyup(e) {\r\n            // 阻止冒泡，防止触发复制、粘贴组件操作\r\n            this.canEdit && e.stopPropagation()\r\n            if (e.keyCode == this.ctrlKey) {\r\n                this.isCtrlDown = false\r\n            }\r\n        },\r\n\r\n        handleMousedown(e) {\r\n            // return;\r\n            // 如果可以编辑取消拖动默认事件\r\n            if (this.canEdit) {\r\n                e.stopPropagation()\r\n            }\r\n        },\r\n\r\n        clearStyle(e) {\r\n            e.preventDefault()\r\n            const clp = e.clipboardData\r\n            // 获取刚刚复制好的文本\r\n            const text = clp.getData('text/plain') || ''\r\n            if (text !== '') {\r\n                document.execCommand('insertText', false, text)\r\n            }\r\n\r\n            this.$emit('input', this.element, e.target.innerHTML)\r\n        },\r\n\r\n        handleBlur(e) {\r\n            this.element.propValue.text = e.target.innerHTML || '&nbsp;'\r\n            const html = e.target.innerHTML\r\n            if (html !== '') {\r\n                this.element.propValue.text = e.target.innerHTML\r\n            } else {\r\n                this.element.propValue.text = ''\r\n                this.$nextTick(() => {\r\n                    this.element.propValue.text = '&nbsp;'\r\n                })\r\n            }\r\n            this.canEdit = false\r\n        },\r\n\r\n        setEdit() {\r\n            if (this.element.isLock) return\r\n\r\n            this.canEdit = true\r\n            // 全选\r\n            // 通过ref取得整个DOM div\r\n            this.selectText(this.$refs.text)  \r\n        },\r\n\r\n        // 双击让光标获取整个句子\r\n        selectText(element) {\r\n            // selection 是获取光标中的字段\r\n            const selection = window.getSelection()\r\n            const range = document.createRange()\r\n\r\n            // 用range可以获取到光标字段的内容，参数为选取的DOM对象中的文本\r\n            range.selectNodeContents(element)\r\n\r\n            // 清除掉刚刚selection中的字段，在把range获取到的文本加进来\r\n            selection.removeAllRanges()\r\n            selection.addRange(range)\r\n        },\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.v-text {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: table;\r\n\r\n    div {\r\n        display: table-cell;\r\n        width: 100%;\r\n        height: 100%;\r\n        outline: none;\r\n        word-break: break-all;\r\n        padding: 4px;\r\n    }\r\n\r\n    .canEdit {\r\n        cursor: text;\r\n        height: 100%;\r\n    }\r\n}\r\n\r\n.preview {\r\n    user-select: none;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Component.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Component.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Component.vue?vue&type=template&id=57d2fc54&scoped=true&\"\nimport script from \"./Component.vue?vue&type=script&lang=js&\"\nexport * from \"./Component.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Component.vue?vue&type=style&index=0&id=57d2fc54&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"57d2fc54\",\n  null\n  \n)\n\nexport default component.exports","var render, staticRenderFns\nimport script from \"./OnEvent.vue?vue&type=script&lang=js&\"\nexport * from \"./OnEvent.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<script>\r\nimport eventBus from '@/utils/eventBus'\r\n\r\nexport default {\r\n    props: {\r\n        linkage: {\r\n            type: Object,\r\n            default: () => {},\r\n        },\r\n        element: {\r\n            type: Object,\r\n            default: () => {},\r\n        },\r\n    },\r\n    created() {\r\n        if (this.linkage?.data?.length) {\r\n            eventBus.$on('v-click', this.onClick)\r\n            eventBus.$on('v-hover', this.onHover)\r\n            eventBus.$on('v-dblclick', this.onDblclick)\r\n        }\r\n    },\r\n    mounted() {\r\n        const { data, duration } = this.linkage || {}\r\n        if (data?.length) {\r\n            this.$el.style.transition = `all ${duration}s`\r\n        }\r\n    },\r\n    beforeDestroy() {\r\n        if (this.linkage?.data?.length) {\r\n            eventBus.$off('v-click', this.onClick)\r\n            eventBus.$off('v-hover', this.onHover)\r\n            eventBus.$off('v-dblclick', this.onDblclick)\r\n        }\r\n    },\r\n    methods: {\r\n        changeStyle(data = []) {\r\n            data.forEach(item => {\r\n                item.style.forEach(e => {\r\n                    if (e.key) {\r\n                        this.element.style[e.key] = e.value\r\n                    }\r\n                })\r\n            })\r\n        },\r\n\r\n        onClick(componentId) {\r\n            const data = this.linkage.data.filter(item => item.id === componentId && item.event === 'v-click')\r\n            this.changeStyle(data)\r\n        },\r\n\r\n        onDblclick(componentId) {\r\n            const data = this.linkage.data.filter(item => item.id === componentId && item.event === 'v-dblclick')\r\n            console.log('v-dblclick')\r\n            this.changeStyle(data)\r\n        },\r\n\r\n        onHover(componentId) {\r\n            const data = this.linkage.data.filter(item => item.id === componentId && item.event === 'v-hover')\r\n            this.changeStyle(data)\r\n        },\r\n    },\r\n}\r\n</script>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OnEvent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OnEvent.vue?vue&type=script&lang=js&\""],"names":["render","_vm","this","_c","_self","editMode","staticClass","on","handleKeydown","handleKeyup","ref","class","canEdit","style","verticalAlign","element","attrs","id","domProps","_s","propValue","text","setEdit","clearStyle","handleMousedown","handleBlur","handleInput","openLink","staticRenderFns","extends","props","type","require","default","data","ctrlKey","isCtrlDown","computed","methods","window","e","document","selectText","range","selection","component","linkage","created","eventBus","mounted","duration","beforeDestroy","changeStyle","item","onClick","onDblclick","console","onHover"],"sourceRoot":""}