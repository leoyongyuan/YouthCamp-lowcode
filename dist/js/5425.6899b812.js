"use strict";(self["webpackChunklowcode_demo"]=self["webpackChunklowcode_demo"]||[]).push([[5425],{55425:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var o=function(){var e=this,t=e._self._c;return"edit"==e.editMode?t("div",{staticClass:"v-text",on:{keydown:e.handleKeydown,keyup:e.handleKeyup}},[t("div",{ref:"text",class:{"can-edit":e.canEdit},style:{verticalAlign:e.element.style.verticalAlign},attrs:{contenteditable:e.canEdit,tabindex:"0"},domProps:{innerHTML:e._s(e.element.propValue)},on:{dblclick:e.setEdit,paste:e.clearStyle,mousedown:e.handleMousedown,blur:e.handleBlur,input:e.handleInput}})]):t("div",{staticClass:"v-text preview"},[t("div",{style:{verticalAlign:e.element.style.verticalAlign},domProps:{innerHTML:e._s(e.element.propValue)}})])},i=[],l=n(20629),c=n(39657),s=n(7608),a={extends:s.Z,props:{propValue:{type:String,required:!0,default:""},element:{type:Object,default:()=>{}},linkage:{type:Object,default:()=>{}}},data(){return{canEdit:!1,ctrlKey:17,isCtrlDown:!1,cancelRequest:null}},computed:{...(0,l.rn)(["editMode"])},created(){this.request&&(this.cancelRequest=request(this.request,this.element,"propValue","string"))},beforeDestroy(){this.request&&this.cancelRequest()},methods:{handleInput(e){this.$emit("input",this.element,e.target.innerHTML)},handleKeydown(e){this.canEdit&&e.stopPropagation(),e.keyCode==this.ctrlKey?this.isCtrlDown=!0:(this.isCtrlDown&&this.canEdit&&c.k.includes(e.keyCode)||46==e.keyCode)&&e.stopPropagation()},handleKeyup(e){this.canEdit&&e.stopPropagation(),e.keyCode==this.ctrlKey&&(this.isCtrlDown=!1)},handleMousedown(e){this.canEdit&&e.stopPropagation()},clearStyle(e){e.preventDefault();const t=e.clipboardData,n=t.getData("text/plain")||"";""!==n&&document.execCommand("insertText",!1,n),this.$emit("input",this.element,e.target.innerHTML)},handleBlur(e){this.element.propValue=e.target.innerHTML||"&nbsp;";const t=e.target.innerHTML;""!==t?this.element.propValue=e.target.innerHTML:(this.element.propValue="",this.$nextTick((()=>{this.element.propValue="&nbsp;"}))),this.canEdit=!1},setEdit(){this.canEdit=!0,this.selectText(this.$refs.text)},selectText(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}}},r=a,d=n(1001),u=(0,d.Z)(r,o,i,!1,null,"17110355",null),h=u.exports},7608:function(e,t,n){n.d(t,{Z:function(){return d}});var o,i,l=n(54003),c={props:{linkage:{type:Object,default:()=>{}},element:{type:Object,default:()=>{}}},created(){this.linkage?.data?.length&&(l.Z.$on("v-click",this.onClick),l.Z.$on("v-hover",this.onHover),l.Z.$on("v-dblclick",this.onDblclick))},mounted(){const{data:e,duration:t}=this.linkage||{};e?.length&&(this.$el.style.transition=`all ${t}s`)},beforeDestroy(){this.linkage?.data?.length&&(l.Z.$off("v-click",this.onClick),l.Z.$off("v-hover",this.onHover),l.Z.$on("v-dblclick",this.onDblclick))},methods:{changeStyle(e=[]){e.forEach((e=>{e.style.forEach((e=>{e.key&&(this.element.style[e.key]=e.value)}))}))},onClick(e){const t=this.linkage.data.filter((t=>t.id===e&&"v-click"===t.event));this.changeStyle(t)},onDblclick(e){const t=this.linkage.data.filter((t=>t.id===e&&"v-dblclick"===t.event));console.log("v-dblclick"),this.changeStyle(t)},onHover(e){const t=this.linkage.data.filter((t=>t.id===e&&"v-hover"===t.event));this.changeStyle(t)}}},s=c,a=n(1001),r=(0,a.Z)(s,o,i,!1,null,null,null),d=r.exports},54003:function(e,t,n){var o=n(20144);t["Z"]=new o["default"]},39657:function(e,t,n){n.d(t,{Y:function(){return $},k:function(){return w}});var o=n(1434),i=n(20144);new i["default"];const l=17,c=91,s=86,a=67,r=88,d=89,u=90,h=71,m=66,p=76,f=85,k=83,v=80,y=68,g=46,Z=69,w=[66,67,68,69,71,76,80,83,85,86,88,89,90],C={[s]:S,[d]:T,[u]:H,[k]:V,[v]:K,[Z]:R},b={...C,[f]:A},D={...C,[a]:x,[r]:M,[h]:L,[m]:q,[y]:P,[g]:P,[p]:_};let E=!1;function $(){window.onkeydown=e=>{if(!o.Z.state.isInEdiotr)return;const{curComponent:t}=o.Z.state,{keyCode:n}=e;n===l||n===c?E=!0:n==g&&t?(o.Z.commit("deleteComponent"),o.Z.commit("recordSnapshot")):E&&(!D[n]||t&&t.isLock?b[n]&&t&&t.isLock&&(e.preventDefault(),b[n]()):(e.preventDefault(),D[n]()))},window.onkeyup=e=>{e.keyCode!==l&&e.keyCode!==c||(E=!1)},window.onmousedown=()=>{o.Z.commit("setInEditorStatus",!1)}}function x(){o.Z.commit("copy")}function S(){o.Z.commit("paste"),o.Z.commit("recordSnapshot")}function M(){o.Z.commit("cut")}function T(){o.Z.commit("redo")}function H(){o.Z.commit("undo")}function L(){o.Z.state.areaData.components.length&&(o.Z.commit("compose"),o.Z.commit("recordSnapshot"))}function q(){const e=o.Z.state.curComponent;e&&!e.isLock&&"Group"==e.component&&(o.Z.commit("decompose"),o.Z.commit("recordSnapshot"))}function V(){i["default"].$emit("save")}function K(){i["default"].$emit("preview")}function P(){o.Z.state.curComponent&&(o.Z.commit("deleteComponent"),o.Z.commit("recordSnapshot"))}function R(){i["default"].$emit("clearCanvas")}function _(){o.Z.commit("lock")}function A(){o.Z.commit("unlock")}}}]);
//# sourceMappingURL=5425.6899b812.js.map